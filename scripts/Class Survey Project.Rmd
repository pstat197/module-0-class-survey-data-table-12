---
title: "Class Survey Project"
author: "All Members of Table 12"
date: "2025-10-09"
output: pdf_document
---

```{r, include=FALSE}
library(tidyverse)
library(knitr)
library(broom)
library(ggplot2)
library(dplyr)
```

# Executive Summary

# Data Description

# Question of Interest


# Basic Regression of the Class Survey Data
Here, we read in the standardized proficiency score dataset first.
```{r}
csv_path <- "data/PSTAT197A_ Standardized_Proficiency_Score.csv"
df <- read_csv(csv_path, show_col_types = FALSE)

names(df)[names(df) == "Score_Avg (Difficulty of Courses)"] <- "Score_Avg"
```

```{r}
# make sure columns are numeric
df <- df %>%
  mutate(
    Score_Avg        = as.numeric(Score_Avg),
    Prog_Proficiency = as.numeric(Prog_Proficiency),
    Stat_Proficiency = as.numeric(Stat_Proficiency),
    Math_Proficiency = as.numeric(Math_Proficiency)
  ) 

# define pairs and fit models
pairs <- tribble(
  ~y,                  ~x,
  "Prog_Proficiency",  "Score_Avg",
  "Stat_Proficiency",  "Score_Avg",
  "Math_Proficiency",  "Score_Avg"
)

fit_1 <- function(y, x, data) {
  sub <- data %>% select(all_of(c(y, x))) %>% drop_na()
  m   <- lm(reformulate(x, y), data = sub)
  list(
    glance = glance(m) %>% mutate(y = y, x = x, n = nobs(m)),
    tidy   = tidy(m)   %>% mutate(y = y, x = x),
    model  = m,
    data   = sub
  )
}

fits <- pairs %>%
  pmap(fit_1, data = df)
```

```{r}
# summarize coefficients & fit stats
coef_tbl <- map_dfr(fits, "tidy") %>%
  select(y, x, term, estimate, std.error, statistic, p.value)

glance_tbl <- map_dfr(fits, "glance") %>%
  select(y, x, n, r.squared, adj.r.squared, AIC, BIC, sigma, p.value)

kable(coef_tbl, caption = "Regression Coefficients Summary")
kable(glance_tbl, caption = "Model Fit Statistics Summary")
```

```{r}
# Plots with fitted line
plot_one <- function(y, x, data) {
  rngx <- range(data[[x]], na.rm = TRUE) + c(-0.05, 0.05)
  rngy <- range(data[[y]], na.rm = TRUE) + c(-0.5, 0.5)
  
  ggplot(data, aes(x = .data[[x]], y = .data[[y]])) +
    geom_point(
      alpha = 0.7,
      size = 2,
      color = "#2C7FB8",
      position = position_jitter(width = 0.01, height = 0.01)
    ) +
    geom_smooth(
      method = "lm",
      se = TRUE,
      color = "#D95F0E",
      fill = "#FEE0B6" 
    ) +
    coord_cartesian(xlim = rngx, ylim = rngy) +
    labs(
      title = paste(y, "vs", x),
      x = x,
      y = y
    ) +
    theme_minimal(base_size = 12) +
    theme(
      plot.title = element_text(face = "bold", hjust = 0.5),
      panel.grid.minor = element_blank(),
      panel.grid.major = element_line(color = "grey90")
    )
}

plots <- pmap(
  pairs,
  \(y, x) plot_one(y, x, df %>% select(all_of(c(y, x))) %>% drop_na())
)
```

```{r}
plots[[1]]
plots[[2]]
plots[[3]]
```





# Findings



